<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Linear Regression From Scratch - Santhoshkumar R</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>
  <main>
    <div class="main-content">
      <article class="project-detail active" data-page="project-detail">
        <header>
          <h2 class="h2 article-title">Linear Regression From Scratch</h2>
        </header>

        <section class="about-text">
          <p>
            A simple implementation of linear regression using only Python's built-in libraries and NumPy. This helps in understanding the mathematical foundation behind the model.
          </p>
        </section>

        <section class="service">
          <h3 class="h3 service-title" style="color: var(--orange-yellow-crayola);">üîë Key Concepts</h3>
          <ul class="service-list">
            <li class="service-item">
              <div class="service-icon-box">
                <ion-icon name="trending-up-outline"></ion-icon>
              </div>
              <div class="service-content-box">
                <h4 class="h4 service-item-title">Cost Function</h4>
                <p class="service-item-text">
                  Measures how well the model fits the data using Mean Squared Error (MSE).
                </p>
              </div>
            </li>
            <li class="service-item">
              <div class="service-icon-box">
                <ion-icon name="construct-outline"></ion-icon>
              </div>
              <div class="service-content-box">
                <h4 class="h4 service-item-title">Gradient Descent</h4>
                <p class="service-item-text">
                  Optimization technique to minimize the cost by adjusting weights iteratively.
                </p>
              </div>
            </li>
            <li class="service-item">
              <div class="service-icon-box">
                <ion-icon name="code-slash-outline"></ion-icon>
              </div>
              <div class="service-content-box">
                <h4 class="h4 service-item-title">Model Training</h4>
                <p class="service-item-text">
                  Manually computes predictions and updates parameters without using ML libraries.
                </p>
              </div>
            </li>
            <li class="service-item">
              <div class="service-icon-box">
                <ion-icon name="analytics-outline"></ion-icon>
              </div>
              <div class="service-content-box">
                <h4 class="h4 service-item-title">Evaluation</h4>
                <p class="service-item-text">
                  Calculates the error to evaluate the model performance.
                </p>
              </div>
            </li>
          </ul>
        </section>

        <section class="about-text">
          <h3 class="h3 service-title" style="color: var(--orange-yellow-crayola);">üìñ Technologies Used</h3>
          <p>
            Python, NumPy for numerical operations, Matplotlib for plotting. No machine learning libraries are used to maintain clarity of the algorithm.
          </p>
        </section>

        <section class="about-text">
          <h3 class="h3 service-title" style="color: var(--orange-yellow-crayola);">üöÄ Full Implementation with CSV Dataset</h3>
          <p>
            Below is a complete implementation that loads data from a CSV file (<code>training_set.csv</code>), applies gradient descent, and plots the regression line.
          </p>
          <pre style="background: #00000052; padding: 15px; border-radius: 10px; overflow-x: auto; color: var(--light-gray);">
<code>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# -----------------------------
# Step 1: Load Training Dataset
# -----------------------------
training_set = pd.read_csv("training_set.csv")

x_train = training_set["YearsExperience"].values   # Input feature
y_train = training_set["Salary"].values            # Target values

# Visualize data points
plt.scatter(x_train, y_train)
plt.xlabel("YearsExperience")
plt.ylabel("Salary")
plt.show()

# -----------------------------
# Step 2: Cost Function (MSE)
# -----------------------------
def cost_function(x, y, w, b):
    m = len(x)
    cost_sum = 0
    for i in range(m):
        f = w * x[i] + b   # Prediction
        cost = (f - y[i]) ** 2
        cost_sum += cost
    total_cost = (1/(2*m)) * cost_sum
    return total_cost

# -----------------------------
# Step 3: Gradient Calculation
# -----------------------------
def gradient_function(x, y, w, b):
    m = len(x)
    dc_dw = 0
    dc_db = 0
    for i in range(m):
        f = w * x[i] + b
        dc_dw += (f - y[i]) * x[i]
        dc_db += (f - y[i])
    dc_dw = (1/m) * dc_dw
    dc_db = (1/m) * dc_db
    return dc_dw, dc_db

# -----------------------------
# Step 4: Gradient Descent Loop
# -----------------------------
def gradient_descent(x, y, alpha, iterations):
    w = 0
    b = 0
    for i in range(iterations):
        dc_dw, dc_db = gradient_function(x, y, w, b)
        w = w - alpha * dc_dw
        b = b - alpha * dc_db
        # Optional: Uncomment below to track cost every 10000 iterations
        # if i % 10000 == 0:
        #     print(f"Iteration {i}: Cost {cost_function(x, y, w, b)}")
    return w, b

# -----------------------------
# Step 5: Train Model
# -----------------------------
learning_rate = 0.01
iterations = 100000
final_w, final_b = gradient_descent(x_train, y_train, learning_rate, iterations)

print(f"w: {final_w:.4f}, b: {final_b:.4f}")

# -----------------------------
# Step 6: Plot Regression Line
# -----------------------------
plt.scatter(x_train, y_train, label='Data Points')
x_vals = np.linspace(min(x_train), max(x_train), 100)
y_vals = final_w * x_vals + final_b
plt.plot(x_vals, y_vals, color='red', label='Regression Line')
plt.xlabel("YearsExperience")
plt.ylabel("Salary")
plt.legend()
plt.show()</code></pre>
          <!-- <button class="form-btn" style="margin-top: 10px; padding: 8px 16px;" onclick="copyToClipboard(this, event)">
            <span>Copy Code</span>
          </button> -->
        </section>

        <section class="about-text">
          <h3 class="h3 service-title" style="color: var(--orange-yellow-crayola);">‚öôÔ∏è How to Use</h3>
          <p>
            Prepare your data in NumPy arrays, then pass them into the <code>train()</code> function. After training, use the returned weights and bias to make predictions.
          </p>
        </section>

        <section class="about-text">
          <h3 class="h3 service-title" style="color: var(--orange-yellow-crayola);">üßÆ Example</h3>
          <pre style="background: #00000052; padding: 15px; border-radius: 10px; overflow-x: auto; color: var(--light-gray);">
<code># Example usage
X = np.array([[1], [2], [3], [4], [5]])
y = np.array([3, 5, 7, 9, 11])  # y = 2x + 1

weights, bias = train(X, y)
print("Weights:", weights)
print("Bias:", bias)

y_pred = predict(X, weights, bias)
print("Predictions:", y_pred)</code></pre>
        </section>

        <section class="about-text">
          <h3 class="h3 service-title" style="color: var(--orange-yellow-crayola);">üßë‚Äçüíª Code</h3>
          <p>
            <b>GitHub: <u style="color: var(--orange-yellow-crayola);"><a href="https://github.com/santhoshclx/LinearRegressionFromScratch" target="_blank" style="color: var(--orange-yellow-crayola);">Linear Regression From Scratch</a><br></u></b>
          </p>
        </section>

      </article>
    </div>
  </main>

  <script>
  function copyToClipboard(button, event) {
    event.stopPropagation();
    const pre = button.previousElementSibling;
    const code = pre.querySelector('code').innerText;
    
    navigator.clipboard.writeText(code).then(() => {
      const span = button.querySelector('span');
      const originalText = span.innerText;
      span.innerText = "Copied!";
      setTimeout(() => (span.innerText = originalText), 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }
</script>

  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</body>

</html>
